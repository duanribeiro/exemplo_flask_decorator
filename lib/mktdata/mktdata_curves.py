from mktdata.mktdata_base import MktDataBase
import time

from libdatabus import databus
from librisk import update_riskdata

class MktDataCurves(MktDataBase):
    def loop(self):
        # databus.update_from_dict(riskdata_mock(), "RiskData/CURVE")

        while True:
            databus.update_from_dict(marketdata_mock(), "MarketData/Curves")
            update_riskdata()
            time.sleep(10)

    def execute(self):
        pass


def marketdata_mock():
    # fmt: off
    return {"PRE":{"rates_bid":[0.05150519340786966,0.05016407326795437,0.052246216347118124,0.0510110800443318,0.051112265522174294,0.052815785611467325,0.052667576196729134,0.05312246912187159,0.051741679925058855,0.053571563684972415,0.05174862353467105,0.052389422524185304,0.052577666807288516,0.05235497530044339,0.05216888579117163,0.050381063245040526,0.051660319656329376,0.05345127229918839,0.05183006793432968,0.05225626897180681,0.0517455121481932,0.052081873169966146,0.051220723510912725,0.05376584654538793,0.0536556474764136,0.0505349220573844,0.050426077675231315,0.05137203831515047,0.05127251628278732,0.051848990687698576,0.05052867905216719,0.052537500000444874,0.05162383776507442,0.05122334120671151,0.05223411209804348,0.050433975489884375,0.0521555222041583,0.05085311671534822,0.053084881430518635,0.05065588333522588,0.05283411094837101,0.052316452520499955,0.05296155014593647,0.05323100963745489,0.052465746745294375,0.053332927484940354,0.05303864402118627,0.05066605076945142,0.05176446430909126,0.05109155682192955,0.05115577972562696,0.05013898966198955,0.05322826413161441,0.05230497313075961,0.052001365715005195,0.0508260607721033,0.053400685848175054,0.050036685074177356,0.05201589221359962,0.05168713030357007,0.05097332449051908,0.05277840740642562,0.052942473956059055,0.05025409883718411,0.053049893314777406,0.05205212444011505,0.05332595467466415,0.05368630034156556,0.050301164386881064,0.05033013905723486,0.05298642126941509,],"LastUpdate":"2020-06-22 00:12:28","dates":["2020-06-23","2020-07-23","2020-08-23","2020-09-23","2020-10-23","2020-11-23","2020-12-23","2021-01-23","2021-02-23","2021-03-23","2021-04-23","2021-05-23","2021-06-23","2021-07-23","2021-08-23","2021-09-23","2021-10-23","2021-11-23","2021-12-23","2022-01-23","2022-02-23","2022-03-23","2022-04-23","2022-05-23","2022-06-23","2022-07-23","2022-08-23","2022-09-23","2022-10-23","2022-11-23","2022-12-23","2023-01-23","2023-02-23","2023-03-23","2023-04-23","2023-05-23","2023-06-23","2023-07-23","2023-08-23","2023-09-23","2023-10-23","2023-11-23","2023-12-23","2024-01-23","2024-02-23","2024-03-23","2024-04-23","2024-05-23","2024-06-23","2024-07-23","2024-08-23","2024-09-23","2024-10-23","2024-11-23","2024-12-23","2025-01-23","2025-02-23","2025-03-23","2025-04-23","2025-05-23","2025-06-23","2025-07-23","2025-08-23","2025-09-23","2025-10-23","2025-11-23","2025-12-23","2026-01-23","2026-02-23","2026-03-23","2026-04-23",],"rates_offer":[0.05815422387973787,0.056208470288649844,0.057603962247941544,0.058292357137092646,0.05962002437760434,0.055907116109294365,0.05960581600697474,0.05503211412408482,0.05595085188257034,0.05681609430923049,0.05741512039333469,0.057442001452727744,0.056356847649763085,0.05836912181238847,0.05702727282966292,0.05567465166349195,0.05789448544117986,0.05621531140284849,0.05935123089683754,0.05851164701061715,0.05561594777690106,0.05656250838729253,0.059933874910500444,0.05639789510433584,0.057326549340697475,0.05961041844812406,0.05945599988617437,0.055727217984822094,0.0559010446157454,0.0558906338607877,0.05612264016153433,0.05529730638449607,0.05714957091421744,0.05771017370801302,0.059730981507620795,0.0588807095722176,0.05842819665623694,0.059165175332702526,0.05934932525392128,0.058419104765529715,0.058074553315197716,0.055139217170737005,0.05828854895242696,0.05563308265837669,0.05877290719127185,0.05852841978251328,0.05778252336205533,0.05537259721895019,0.05649102500253936,0.058001327952265314,0.05868380260161598,0.05980293034193139,0.057339314688762764,0.05527159434217193,0.05962073213486108,0.05948579030785221,0.059117431217676014,0.0580010527628904,0.0567854529390988,0.0588768897939541,0.057220968765095664,0.05737627127781163,0.055880506108241135,0.05787180511700191,0.05664109505874886,0.05587168529701801,0.05813850797421822,0.058443050704911126,0.0582175416505006,0.05523062472470431,0.05651918534550438,],},"USD_Onshore":{"rates_bid":[0.028087483393165417,0.028450600607688992,0.02746174339388761,0.02786981306358753,0.02832805539358324,0.02881527860605991,0.02550545824073705,0.028774917936585605,0.02822425647481306,0.026215030205199417,0.027628196984587565,0.025660462033056903,0.025718297553206846,0.025269589819184646,0.025118111617174785,0.02530673257040739,0.027666058083521794,0.02840798440629208,0.02722900305110284,0.028566709202352353,0.026452693747734367,0.02851142550259133,0.027343299992235698,0.02868673649302004,0.027085797422159063,0.02630152752705848,0.027682562592594162,0.025558919385971234,0.025099343488570205,0.025884956724945247,0.02780323496749902,0.027168729946548845,0.025661192948944516,0.0253221254302195,0.027580838258385126,0.02808287183737804,0.025842749317010954,0.02892760148964944,0.028863978774714527,0.02712443542528642,0.028901115526953524,0.025953135422171453,0.025265194240258863,0.02822151426395777,0.026448532263349447,0.02510762348709902,0.028414720058102166,0.028612087501848807,0.02756644113299704,0.026671559453706854,0.02872630954019226,0.02751647499350299,0.026442938074559566,0.027319505900819087,0.025136703681220278,0.026028800041985593,0.025290839075105903,0.026772032921349286,0.026300253763427265,0.027060768759991444,0.02584100169763062,0.02629221217955086,0.025680628557078054,0.026065198302722855,0.02533984895727893,0.025010630797680275,0.026002078602837576,0.02528968717821446,0.02757039689547563,0.026673899124046652,0.02668438532547303,0.02866758732125153,0.027127787156627153,0.027950811918728564,0.025972064705904723,0.027912663898584825,0.02577004317051287,0.027855579894840984,0.027767684053288274,0.027663801649974375,0.026128035702588273,0.02679937531719543,0.02555064914743531,0.027633904106819734,0.028193570994489384,0.025327249784224876,0.02704924885172721,0.028842819225413364,0.025800214976172825,0.02573288637387918,0.027222800664799967,0.028613969448860195,],"LastUpdate":"2020-06-22 00:12:28","dates":["2020-06-23","2020-07-23","2020-08-23","2020-09-23","2020-10-23","2020-11-23","2020-12-23","2021-01-23","2021-02-23","2021-03-23","2021-04-23","2021-05-23","2021-06-23","2021-07-23","2021-08-23","2021-09-23","2021-10-23","2021-11-23","2021-12-23","2022-01-23","2022-02-23","2022-03-23","2022-04-23","2022-05-23","2022-06-23","2022-07-23","2022-08-23","2022-09-23","2022-10-23","2022-11-23","2022-12-23","2023-01-23","2023-02-23","2023-03-23","2023-04-23","2023-05-23","2023-06-23","2023-07-23","2023-08-23","2023-09-23","2023-10-23","2023-11-23","2023-12-23","2024-01-23","2024-02-23","2024-03-23","2024-04-23","2024-05-23","2024-06-23","2024-07-23","2024-08-23","2024-09-23","2024-10-23","2024-11-23","2024-12-23","2025-01-23","2025-02-23","2025-03-23","2025-04-23","2025-05-23","2025-06-23","2025-07-23","2025-08-23","2025-09-23","2025-10-23","2025-11-23","2025-12-23","2026-01-23","2026-02-23","2026-03-23","2026-04-23","2026-05-23","2026-06-23","2026-07-23","2026-08-23","2026-09-23","2026-10-23","2026-11-23","2026-12-23","2027-01-23","2027-02-23","2027-03-23","2027-04-23","2027-05-23","2027-06-23","2027-07-23","2027-08-23","2027-09-23","2027-10-23","2027-11-23","2027-12-23","2028-01-23",],"rates_offer":[0.032759059876039345,0.03162480329934581,0.034318842117240185,0.034674683680041604,0.03261320466990584,0.032827986202466304,0.034836919085281984,0.034803904929108,0.03324982226731039,0.03415893627775836,0.03449333809449039,0.033366473772244325,0.034498406159356024,0.03228387510781865,0.03224589218221933,0.030684845815919314,0.03492056576072501,0.03205403925301648,0.03451179107365543,0.03099849054846963,0.03402007887599181,0.03173529401909357,0.034320189393659314,0.030838364799006895,0.03227205165054452,0.03389947151904931,0.03171048267977664,0.03316088593360301,0.03275324404111338,0.03203138270383263,0.03065796235994165,0.03114350406323841,0.030618095935877224,0.03306665301564558,0.030906416264502592,0.03190155518288704,0.03353241212957592,0.034215581427721825,0.03498386788967317,0.03065799268348149,0.034180249308858476,0.03486976263394804,0.03057933648945371,0.034402354417637726,0.03327301317171959,0.030933674491826556,0.03190746426878162,0.030473786140487485,0.03431622493294116,0.030980804026216228,0.03385498659849912,0.034119566855577495,0.03263582818385489,0.034228679829332705,0.032178124077884625,0.03174267425472903,0.0312368451254922,0.03052414221599052,0.030440210482155443,0.03210680135726102,0.031722746282686495,0.03160323630393193,0.03357482912581287,0.03240397920251068,0.03434747940409558,0.03305212341482227,0.032499575434626095,0.032511832012723875,0.03040959707412013,0.03408270601670005,0.033960442425507775,0.034740152676862056,0.03434859499722528,0.031524660498138124,0.0309827633441414,0.03115788211558709,0.03471778061274779,0.030265033100778587,0.03171592405895502,0.0335915150685212,0.03297657434830269,0.03489030421726108,0.03490977447135875,0.030362198446415682,0.03485547941614004,0.03286652360973947,0.03338800046340984,0.033117597925894714,0.034101412609360636,0.0315894987284298,0.03315297363598573,0.030196994299088425,],},"JPY_Onshore":{"rates_bid":[0.002276872468847193,0.0019051332146597874,0.0023257896270263197,0.0010326266826537677,0.0012182980524319848,0.0021536716683032476,0.00223437508140935,0.0011762352640547812,0.0016055046976070336,0.0018697312889415696,0.0010925688146226637,0.0019063257489838215,0.00211833496286945,0.0022327690154564646,0.0012599804342923058,0.002015309016043805,0.001397632152174986,0.0020836448672776303,0.0017317700173145123,0.0023962876402684697,0.002284743193770683,0.0018104288984475258,0.0017080337736477417,0.0015486906990949134,0.0015460977424771646,0.0019398645890354566,0.002303798429623241,0.001278171987809241,0.0016605643376516436,0.0015615933897214548,0.0012356867227675157,0.0018035731426951822,0.002327625907547459,0.002253306509505288,0.0013965398919054532,0.001876618420507601,0.0016970997544864777,0.0021008052512797287,0.0015663115219666885,0.0013374048023953099,0.001289943799497265,0.0023245527118741253,0.001099039399251846,0.0018711270232751546,0.0018696798634450125,0.0017252072703455097,0.0018090897565858546,0.0014010353602625274,0.001940267012294077,0.001278831264449092,0.0023061259513498696,0.0017586349148971273,0.0014020863814944368,0.0012571004442170455,0.0012262383458965138,0.0021174999735456518,0.001180034374708053,],"LastUpdate":"2020-06-22 00:12:28","dates":["2020-06-23","2020-07-23","2020-08-23","2020-09-23","2020-10-23","2020-11-23","2020-12-23","2021-01-23","2021-02-23","2021-03-23","2021-04-23","2021-05-23","2021-06-23","2021-07-23","2021-08-23","2021-09-23","2021-10-23","2021-11-23","2021-12-23","2022-01-23","2022-02-23","2022-03-23","2022-04-23","2022-05-23","2022-06-23","2022-07-23","2022-08-23","2022-09-23","2022-10-23","2022-11-23","2022-12-23","2023-01-23","2023-02-23","2023-03-23","2023-04-23","2023-05-23","2023-06-23","2023-07-23","2023-08-23","2023-09-23","2023-10-23","2023-11-23","2023-12-23","2024-01-23","2024-02-23","2024-03-23","2024-04-23","2024-05-23","2024-06-23","2024-07-23","2024-08-23","2024-09-23","2024-10-23","2024-11-23","2024-12-23","2025-01-23","2025-02-23",],"rates_offer":[0.003358142902650684,0.004786383424414993,0.0029124839212193256,0.0030222402742831,0.004581624428896406,0.004773443841890957,0.0027957289243698744,0.004892812292488097,0.004249098715391518,0.003145866520178261,0.00271845583207691,0.0029327301732076185,0.003146838646971142,0.00495249373539592,0.0036930073177034563,0.0034889571512686105,0.0039340013978481645,0.00268844420137712,0.004322628343289603,0.004439682232644976,0.004112330093119907,0.0047989059399740856,0.0043346519331913455,0.003088749937282441,0.002949895146028945,0.0030740747138620177,0.004611741816387947,0.002639754121333889,0.004679920775351299,0.003387452132766524,0.0036120890138140183,0.004637730561585814,0.003996997047499133,0.003130255851468436,0.0033730136037718773,0.0041770773903076555,0.004785475035816712,0.0034744915283575796,0.0027970291186152395,0.0038436033970728157,0.004685551313757906,0.0028363804004695624,0.003788798094349313,0.004927444664192703,0.0036001657473704925,0.004995636084511612,0.00268108870786744,0.004455940531789243,0.004808960125545657,0.004096618513335814,0.0032629922224347505,0.004507175740510454,0.002924028565191914,0.0032374599059315557,0.002950916600525183,0.003839127761015757,0.004436973662627259,],},"EUR_Onshore":{"rates_bid":[0.002169120196572705,0.003716751100518322,0.0014206158735432272,0.0023623067081848135,0.003044491972115428,0.00393949408303111,0.003298752721232689,0.001762730092542714,0.001360249624694756,0.002520011768518572,0.0021175836749968754,0.0023723852183421684,0.003383256722428503,0.0014375236038468272,0.0029186061622551683,0.0030564123204650994,0.001538703340065263,0.001070578023773928,0.0011760152076756647,0.001731311781984642,0.0033036262788450205,0.0037597462320605544,0.0012781715617853268,0.0011731496131099427,0.0023142876429580964,0.002280162524010994,0.001225406186832749,],"LastUpdate":"2020-06-22 00:12:28","dates":["2020-06-23","2020-07-23","2020-08-23","2020-09-23","2020-10-23","2020-11-23","2020-12-23","2021-01-23","2021-02-23","2021-03-23","2021-04-23","2021-05-23","2021-06-23","2021-07-23","2021-08-23","2021-09-23","2021-10-23","2021-11-23","2021-12-23","2022-01-23","2022-02-23","2022-03-23","2022-04-23","2022-05-23","2022-06-23","2022-07-23","2022-08-23",],"rates_offer":[0.006102750319383195,0.006403766059702341,0.0074648925259645,0.008609999286379618,0.007210652374751152,0.005241359644123893,0.009936455993573241,0.008571316457849889,0.007307752261209766,0.008094498486775693,0.006790202605312576,0.008118355068495758,0.005043523521359067,0.005137475581004633,0.009950279493196485,0.007231984912282271,0.007213070200839196,0.007149734755221898,0.009312033656257622,0.008845232311174837,0.009241982867034957,0.009116389267553777,0.0071608422597572875,0.005712256018023544,0.005731022364488764,0.008937454387305675,0.007469736760934766,],}}
    # fmt: on

    # def riskdata_mock():
    #     return {
    #         "USD_Onshore": {
    #             "LastUpdate": "2020-06-22 00:12:28",
    #             "RiskVertices": [30, 60, 90, 180, 360, 720, 1080],
    #             "RatesBid": [
    #                 0.02845019707295382,
    #                 0.027494689977686892,
    #                 0.02784260337747213,
    #                 0.02588248423641981,
    #                 0.025707880699918917,
    #                 0.027637811009298963,
    #                 0.026982272751908676,
    #             ],
    #             "RatesOffer": [
    #                 0.03162606289287395,
    #                 0.03422892757776963,
    #                 0.034650957100974766,
    #                 0.034607554619233705,
    #                 0.034294445108674854,
    #                 0.03177723023259582,
    #                 0.032702048418347784,
    #             ],
    #             "ViewPriority": "2",
    #             "RiskLabels": ["1M", "2M", "3M", "6M", "1Y", "2Y", "3Y"],
    #         },
    #         "PRE": {
    #             "LastUpdate": "2020-06-22 00:12:28",
    #             "RiskVertices": [21, 42, 63, 126, 252, 504, 756],
    #             "RatesBid": [
    #                 0.05016987529491468,
    #                 0.052137521884044524,
    #                 0.05112864958272656,
    #                 0.05268473790707251,
    #                 0.05257766680728859,
    #                 0.053655647476413604,
    #                 0.052088726077957226,
    #             ],
    #             "RatesOffer": [
    #                 0.05621688574879902,
    #                 0.05753113593685533,
    #                 0.05822677641877938,
    #                 0.05917684092764075,
    #                 0.05635684764976312,
    #                 0.057326549340697586,
    #                 0.05846595921604458,
    #             ],
    #             "ViewPriority": "1",
    #             "RiskLabels": ["1M", "2M", "3M", "6M", "1Y", "2Y", "3Y"],
    #         },
    #         "JPY_Onshore": {
    #             "LastUpdate": "2020-06-22 00:12:28",
    #             "RiskVertices": [30, 60, 90, 180, 360, 720, 1080],
    #             "RatesBid": [
    #                 0.001905546181754092,
    #                 0.00231176490155538,
    #                 0.001118785616316842,
    #                 0.002225168585893833,
    #                 0.0020801471955689266,
    #                 0.001546992265283098,
    #                 0.0017884636578000546,
    #             ],
    #             "RatesOffer": [
    #                 0.00478479536282439,
    #                 0.0029748908971274357,
    #                 0.0030149228104028314,
    #                 0.0030211380742530825,
    #                 0.003108272724708927,
    #                 0.0029977953887281306,
    #                 0.004475778574087208,
    #             ],
    #             "ViewPriority": "4",
    #             "RiskLabels": ["1M", "2M", "3M", "6M", "1Y", "2Y", "3Y"],
    #         },
    #         "EUR_Onshore": {
    #             "LastUpdate": "2020-06-22 00:12:28",
    #             "RiskVertices": [30, 60, 90, 180, 360, 720, 1080],
    #             "RatesBid": [
    #                 0.0037150301850181755,
    #                 0.0014970690206235204,
    #                 0.002299499778791292,
    #                 0.0033718240299984714,
    #                 0.0032011159157339097,
    #                 0.0019204685923552844,
    #                 0.001225406186832749,
    #             ],
    #             "RatesOffer": [
    #                 0.0064034315477974335,
    #                 0.0074295036247900015,
    #                 0.008533618359262807,
    #                 0.009399761057131029,
    #                 0.005596630542339387,
    #                 0.005724548271708763,
    #                 0.007469736760934766,
    #             ],
    #             "ViewPriority": "3",
    #             "RiskLabels": ["1M", "2M", "3M", "6M", "1Y", "2Y", "3Y"],
    #         },
    #     }
